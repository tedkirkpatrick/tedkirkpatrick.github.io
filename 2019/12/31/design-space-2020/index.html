<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="description" content="Blog for A. E. Kirkpatrick and  Kirkpatrick Computing Services">
  <meta name="author" content="Arthur E. Kirkpatrick">
  <meta name="copyright" content="Arthur E. Kirkpatrick, 2018, 2019, 2020">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      The service design space (2020 Edition) &middot; All my marbles in one place
    
  </title>

  <!-- Google Analytics -->
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66576928-4', 'auto');
  ga('send', 'pageview');
  </script>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Begin Jekyll SEO tag v2.2.3 -->
<meta property="og:title" content="The service design space (2020 Edition)" />
<meta name="author" content="Ted Kirkpatrick" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Post in an ongoing series on the issues constraining service design for datacentres. A previous post presented 2019’s version, a design space for data engineering." />
<meta property="og:description" content="Post in an ongoing series on the issues constraining service design for datacentres. A previous post presented 2019’s version, a design space for data engineering." />
<meta property="og:site_name" content="All my marbles in one place" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-12-31T00:00:00-08:00" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"BlogPosting","headline":"The service design space (2020 Edition)","author":{"@type":"Person","name":"Ted Kirkpatrick"},"datePublished":"2019-12-31T00:00:00-08:00","dateModified":"2019-12-31T00:00:00-08:00","description":"Post in an ongoing series on the issues constraining service design for datacentres. A previous post presented 2019’s version, a design space for data engineering.","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/12/31/design-space-2020/"},"url":"/2019/12/31/design-space-2020/"}</script>
<!-- End Jekyll SEO tag -->

</head>


  <body class="theme-base-0c layout-reverse">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          All my marbles in one place
        </a>
      </h1>
      <p class="lead">A blog about course design, data display, C++, and Python.  Yes, these are related, at least as I see them.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/comment-policy/">Comment policy</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/credits/">Credits</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

    
        <div class="sidebar-tags">
        Tags:<br/>
        
	   
	    <a href="/tag/C++/">C++</a>,
	  
        
	   
	    <a href="/tag/Python/">Python</a>,
	  
        
	   
	    <a href="/tag/Course design/">Course design</a>,
	  
        
	   
	    <a href="/tag/Big data/">Big data</a>,
	  
        
	   
	    <a href="/tag/Soft skills/">Soft skills</a>,
	  
        
	   
	    <a href="/tag/Statistics/">Statistics</a>,
	  
        
	   
	    <a href="/tag/Experimental design/">Experimental design</a>,
	  
        
	   
	    <a href="/tag/Rhetoric/">Rhetoric</a>,
	  
        
	   
	    <a href="/tag/Admin/">Admin</a>,
	  
        
	  	    
            <a href="/tag/Distributed systems/">Distributed systems</a>
          
        
	</div>
      

    </nav>

    <p>&copy; 2020. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">The service design space (2020 Edition)</h1>
  <span class="post-date">31 Dec 2019
  
    <span class="tag-block">Tags: 
    
      
      <a href="/tag/Course design">Course design</a>
      
    
    </span>
  
  </span>
  
  <p><em>Post in an ongoing series on the issues constraining service design
 for datacentres. A previous post presented 2019’s
 version,
 <a href="/2018/10/13/data-engineering-design-space/">a design space for data engineering</a>.</em></p>

<p>Starting January 2020, I will teach a course on service design for
datacentres. The roster indicates that nearly all students will be in
a professional master’s program. Most will be in their second semester
of a program in Big Data, some will be in their fifth semester
(including a two-semester paid internship), with a few in other
programs.</p>

<p>This will be a revision of the course that I taught in
Spring 2019. I was generally satisfied with that version and do
not want to mess it up through excessive
revision. <a href="https://robertgreiner.com/the-second-system-effect/">“Second System Effect”</a>
is as much an issue in course design as it is in system design.</p>

<h2 id="defining-the-course-focus-as-service-design-for-datacentres">Defining the course focus as “service design for datacentres”</h2>

<p>I want this course to provide students with the essential skills for
designing and analyzing service-based architectures that will run in
contemporary datacentre environments. This goal is broad, encompassing
both practice using exemplary technologies and the underlying principles.</p>

<p>I have taught variations of this topic since 2014.  Each year, I have
struggled to define a succinct characterization. There doesn’t seem to
be an accepted term for this material in either the academic or
industrial literatures. Most troubling, I have not found a phrase that
both appeals to students and accurately indicates what they are going
to learn.</p>

<p>Calling it <strong>“cloud computing”</strong> sets the wrong expectation. Cloud
computing typically refers to managed services offered by such
providers as Alibaba, Amazon, Google, or Microsoft. These services are
often categorized according to the
<a href="https://www.bmc.com/blogs/saas-vs-paas-vs-iaas-whats-the-difference-and-how-to-choose/">Infrastructure-as-a-service (IaaS), Platform-as-a-Service (PaaS), and Application-as-a-Service (AaaS) model</a>. A
cloud computing course would emphasize that designers should first
consider all the managed service offerings from their chosen provider,
as well as aftermarket providers, before designing a custom
solution. Why build and operate a data store in-house when DynamoDB,
BigTable, or Azure Store could meet your needs?  By contrast, this
course is concerned with how you connect services together and how you
will know when you need to purpose-build your own.</p>

<p>Calling it <strong>“distributed systems”</strong> misleads in a different way. Such
courses focus on the design of distributed systems in general, often
with a focus on the correctness and complexity of distributed
algorithms. Nancy Lynch’s 1996
<a href="https://groups.csail.mit.edu/tds/distalgs.html"><em>Distributed Algorithms</em></a>
is a common text. This theory provides the essential underpinning of
the material I want to teach but it would take an entire semester to
cover in its own right and the material is not of strong interest to
students in a professional master’s program. This course focuses
instead on the implications of the above theoretical results for actual
system design.</p>

<p>Last year, I attempted to make the material relevant to Big Data
students by framing it in terms of <strong>“data engineering”</strong>. This now
seems incomplete to me.  Although descriptions of data engineering
include core concepts from this course:</p>

<blockquote>
  <p>Most of the issues that you’ll run into will be around reliability
and distributed systems. … you’ll need a system that can
automatically scale your server count up and down … data engineering is about learning to deal with scale and efficiency.<br />
—<cite><small><a href="https://www.dataquest.io/blog/what-is-a-data-engineer/">What is a Data Engineer?</a></small></cite></p>
</blockquote>

<blockquote>
  <p>[Data engineers] need some understanding of distributed systems in general and
how they are different from traditional storage and processing
systems.<br />
—<cite><small><a href="https://www.oreilly.com/ideas/data-engineering-a-quick-and-simple-definition">Data Engineering: A Quick and Simple Definition</a></small></cite></p>
</blockquote>

<p>the descriptions also list many other topics:</p>

<blockquote>
  <p>A good data engineer has extensive knowledge on databases and best
engineering practices. These include … building
human-fault-tolerant pipelines, …
knowledge of database administration, maintaining data cleaning,
and ensuring a deterministic pipeline.<br />
—<cite><small><a href="https://blog.insightdatascience.com/data-science-vs-data-engineering-62da7678adaa">Data Science vs. Data Engineering</a></small></cite></p>
</blockquote>

<p>I would now say that this course is more about the infrastructure
underlying data engineering than data engineering itself.</p>

<p>Ultimately, I am left with the phrase, <strong>“service design for
datacentres”</strong>. It has the merit of precisely specifying the course
focus but the oh-so-considerable demerit of being opaque to everyone
else, both prospective students and fellow faculty.</p>

<h3 id="the-topic-phrase-comprises-theory-and-practice">The topic phrase comprises theory and practice</h3>

<p>So what does “service design for datacentres” imply? Broadly, it is
the design of services intended to run on a network of large-scale
datacentres. A high proportion of modern software involves the
design of such services, from edge computing in embedded devices, to
middleware that processes and stores the data relayed from the edge,
to the interfaces by which end users interact with that data and
administrators manage the services. In the near future, it is likely
that virtually every program written will provide a service interface
to other programs and call other programs through their service
interface, all mediated by networks.</p>

<p>Most of these programs will
run inside large datacentres. This execution context has major
constraints for the architecture running upon it:</p>

<ul>
  <li>A service will scale by adding or removing replicas</li>
  <li>A service will need to tolerate failures of services it calls</li>
  <li>A service will need to be able provide degraded or approximate
service to its callers when it
fails partially</li>
  <li>A service will have performance objectives, the most important of
which will typically specify permissible latencies</li>
</ul>

<h3 id="service-interface-but-not-necessarily-micro-service">Service interface but not necessarily <em>micro</em>-service</h3>

<p>This does not necessarily imply a microservice architecture. Although
that is an important design choice in contemporary systems, and one
that will be covered in the course, it is ultimately an internal
choice, one of several defensible designs for a given application. The
key points that will characterize virtually all designs are that they
expose their functionality through a service-based interface, hide
their internal decisions behind that interface, and communicate over
a network. The granularity of those components is an implementation choice.</p>

<h2 id="student-background">Student background</h2>

<p>Most of the students will fit the following profile:</p>

<dl>
  <dt>Program entry requirements</dt>
  <dd>Bachelor’s degree in CS or related field.</dd>
  <dt>Courses students took in prior semesters</dt>
  <dd>In their first semester, students will already have taken a course
on machine learning and a lab introducing them to technologies of
large-scale data analysis, including HDFS, Hadoop, Spark, Cassandra,
and HBase. Some may have taken electives in visualization or natural
language processing.

    <p>Students taking the course in their second year will have at least
two academic semesters and a two-semester internship behind them.
This group will have taken a range of electives in their second semester.</p>
  </dd>
  <dt>Courses students take concurrently</dt>
  <dd>Concurrently with the data engineering course, they will be taking a
second lab, focussed on applied statistical analysis and machine
learning. They will also be taking an algorithms course including
Paxos and the Gilbert/Lynch CAP Theorem.</dd>
</dl>

<h2 id="approach">Approach</h2>

<p>Given the lengthy topic list that follows, the course can only provide
a broad survey, not deep understanding but if the students become
comfortable with these concepts, they will be prepared for a broad
range of roles in modern computing environments.</p>

<p>The course runs on two tracks:</p>

<ul>
  <li>A tool-based track, introducing  a specific
implementation approach, running
<a href="https://www.openshift.com/">Docker</a> containers on the
<a href="https://www.openshift.com/">OpenShift</a> distribution of
<a href="https://kubernetes.io/">Kubernetes</a>.</li>
  <li>The principles of designing distributed, resilient services for a
datacentre environment.</li>
</ul>

<p>The tools track is neither in-depth nor exhaustive. It simply
introduces one very large suite of components that is widely used for
implementing services on a datacentre. It is far from the only
approach but the widespread use of Docker and Kubernetes means that
there is a good likelihood that students will be able to immediately
apply their course experiences in their internships that immediately
follow this course.</p>

<p>The design principles are organized into the following design space.</p>

<h2 id="the-design-space-of-cloud-services">The design space of cloud services</h2>

<p>Designs can be analyzed according to a variety of criteria. Taken
together, these criteria establish a <em>design space</em> within which to
evaluate and contrast designs. These properties also establish
measures of system success.</p>

<p>These properties can be applied to the system as a whole; many also
characterize system components.</p>

<h2 id="metrics---measured-properties-of-the-system">Metrics—measured properties of the system</h2>

<p>Metrics are measurable properties of the system. They reflect the
match between system architecture and use.</p>

<p>In addition to learning the following concepts, students need to become familiar
with representing the distributions of metrics via key percentiles
(50th, 75th, 90th, …). Students also need to understand the impact
of “long tail” high percentiles, such as the 99th, on aggregate system
performance.</p>

<p>Metrics can be part of <a href="#objectives">objectives</a>.</p>

<h3 id="system-performance-metrics">System performance metrics</h3>

<p>These metrics characterize the system itself, running on a
representative workload:</p>

<ul>
  <li>Latency</li>
  <li>Throughput</li>
  <li>Scalability</li>
  <li>Availability</li>
</ul>

<h3 id="data-centre-fabric-metrics">Data centre fabric metrics</h3>

<p>These metrics characterize the design of the data centre:</p>

<ul>
  <li>Processor performance</li>
  <li>Clock variability</li>
  <li>Bisection bandwidth</li>
  <li>Likelihood of component failures</li>
</ul>

<h3 id="inter-data-centre-round-trip-metrics">Inter-data centre round trip metrics</h3>

<p>For systems running on multiple data centres, perhaps in different
continents, we need to consider the round trip times:</p>

<ul>
  <li>Between availability zones in one region</li>
  <li>Between regions</li>
</ul>

<h3 id="business-metrics">Business metrics</h3>

<p>As described in
<a href="https://www.oreilly.com/webops-perf/free/chaos-engineering.csp">Chaos Engineering, pp. 22–23</a>,
business metrics are specific to your application. They measure how
successfully the application is serving clients and meeting its
purpose. The measurement is often indirect, using some metric as a
proxy for the actually desired indicator, such as “real time customer
satisfaction”.  For example, Netflix measures the number of times the
“start” button is pressed per second.  As their service ultimately is
about streaming video, an unexpected drop in start presses indicates
the service is not meeting its purpose.</p>

<ul>
  <li>Specific to application, measuring “service success” or “client
satisfaction” (often indirectly)</li>
</ul>

<h2 id="guarantees-and-invariants-inherent-properties-of-the-systems-design">Guarantees and invariants: Inherent properties of the system’s design</h2>

<p>Whereas metrics are measurable attributes of a system that can vary with
such factors as system load, properties are fundamental to the
system’s design. For example, the design either replicates durable
data or it does not.</p>

<h3 id="data-durability">Data durability</h3>

<p>Durable data is stored by the system on behalf of the users, typically
on disk or solid-state storage. What sort of guarantees does the
system provide on this data?</p>

<ul>
  <li>Replication for durability</li>
  <li>Replication for availability</li>
  <li>Synchronous vs. asynchronous writes</li>
  <li>Consistency guarantees</li>
</ul>

<p>In principle, consistency guarantees can be made for ephemeral data that only
ever resides in memory but in most cases only eventual consistency
is provided, minimizing processing cost.</p>

<h3 id="data-security-and-privacy">Data security and privacy</h3>

<p>When a service stores data, the designers must consider what
techniques they will adopt to ensure its security and
privacy. Although these concepts are related and partially overlap, it
is useful to distinguish techniques for each:</p>

<dl>
  <dt>Security</dt>
  <dd>Techniques that ensure that data will only be accessed by
authorized individuals and services.</dd>
  <dt>Privacy</dt>
  <dd>Techniques that ensure that that data will only be used for
the purposes for which it was granted to the storing service.</dd>
</dl>

<p>For example, if you provide your address to a service for them to ship
you a product, the service’s <em>security guarantees</em> would ensure that only
employees in the shipping department could see that address, while
their <em>privacy guarantees</em> would ensure that the employees who can see your
address would only use it to ship the product, not to send harassing
mail.</p>

<p>Security and privacy methods include both technical choices and
organizational policy. Ultimately, while the technology can guarantee
that the data will be processed according to rules such as “all
records on persistent storage will be encrypted”, and the policies can
limit access, perfect security and privacy are ideals that can ony be
approached, never achieved. A design establishes barriers to misuse
but sufficiently dedicated individuals with sufficient resources will
always be able to circumvent those barriers.</p>

<h4 id="data-security-techniques">Data security techniques</h4>

<p>Security techniques include:</p>

<ul>
  <li>Encryption, at rest and in transit</li>
  <li>Key management</li>
  <li>Key revocation</li>
  <li>Access roles and rules</li>
</ul>

<h4 id="data-privacy-techniques">Data privacy techniques</h4>

<p>Privacy techniques include:</p>

<ul>
  <li>Differential privacy</li>
  <li>Cell size</li>
</ul>

<h3 id="instrumentation">Instrumentation</h3>

<p>How well does the system support monitoring its current state and
diagnosing problems:</p>

<ul>
  <li>Logs</li>
  <li>Traces</li>
  <li>Dashboards</li>
  <li>Probes</li>
</ul>

<h3 id="fault-tolerance">Fault tolerance</h3>

<p>How well does the system tolerate failure of its own components and
the services and data centre fabric upon which it depends:</p>

<ul>
  <li>Tolerance of component failures within the system</li>
  <li>Tolerance of failure of external services upon which this depends</li>
  <li>Tolerance of larger system failures (availability zone, region,
transoceanic partition, …)</li>
</ul>

<p>How well does it support failure, diagnosis, repair, and restart:</p>

<ul>
  <li>Diagnostic logs</li>
  <li>Canary deployments</li>
  <li>Admission control</li>
  <li>Feature switches</li>
  <li>Approximate results</li>
  <li>Other engineering techniques</li>
</ul>

<h3 id="business-logic-invariants">Business logic invariants</h3>

<p>Business logic invariants are the business property counterparts to
business metrics:  The guarantees the system makes for entities that
the system’s clients care about.  For example, banks maintain the
invariant that if you transfer money between two accounts, the amount
taken from one equals the amount added to the other.</p>

<p><a href="https://www.researchgate.net/publication/220476881_CAP_Twelve_years_later_How_the_Rules_have_Changed">Eric Brewer notes</a>
that many business invariants are only implicitly specified for
single-processor systems, which typically guarantee strong
consistency.  When consistency guarantees are loosened (see
“Properties of durable data” above) to migrate the system to a
distributed implementation, the business invariants need to be
specified explicitly.</p>

<p>Business invariants often must specify a mitigation procedure, to
resolve any violations (see the Brewer article cited above). For
example, what is the process for redressing an error in an account’s
balance, whether due to system defect or human error?</p>

<h3 id="automated-deployment">Automated deployment</h3>

<p>In addition to readying the initial release for production, the
service will require automated support for deploying updates.</p>

<h2 id="objectives">Indicators and objectives</h2>

<p>The above metrics, guarantees, and invariants shape the design space of the
architecture for modern cloud systems.  As such, they are
direct concerns of the the development and operations staff. In
addition, they may be exposed to clients as indicators and
even contractual obligations. 
As defined in
<a href="https://landing.google.com/sre/book/chapters/service-level-objectives.html">Site Reliability Engineering, Ch. 4</a>:</p>

<ul>
  <li>Service Level Indicators (SLI)</li>
  <li>Service Level Objectives (SLO)</li>
  <li>Service Level Agreements (SLA)</li>
</ul>

<h2 id="development-process-metrics">Development process metrics</h2>

<p>The above metrics and properties characterize the system’s design and
performance. Other metrics characterize the development process:</p>

<ul>
  <li>Velocity of feature development (<a href="https://www.oreilly.com/webops-perf/free/chaos-engineering.csp">Chaos Engineering, p. 9</a>)</li>
</ul>

<h2 id="inherent-limitations-of-distributed-systems">Inherent limitations of distributed systems</h2>

<p>Decades of study and practice in distributed systems have yielded
principles and rules of thumb characterizing all such
systems. As modern cloud systems are a species of
distributed system, their designers must account for how these issues
arise in this context.</p>

<p>Properties of distributed systems that must be accounted for (from
<a href="http://www.cs.mcgill.ca/~navindra/kde-devel/kwn-18/smli_tr-94-29.ps.gz">Waldo et al., 1994</a>):</p>

<ul>
  <li>Latency</li>
  <li>Message-passing architecture (no shared memory)</li>
  <li>True concurrency</li>
  <li>Partial failure (process, service, and machine failure)</li>
</ul>

<p>No common system clock
(<a href="https://www.microsoft.com/en-us/research/publication/time-clocks-ordering-events-distributed-system/">Lamport, 1978</a>):</p>

<ul>
  <li>Systems must use some variant of <a href="https://queue.acm.org/detail.cfm?id=2917756">logical clocks</a>, vector clocks, or
interval clocks</li>
</ul>

<p><a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing">“The Eight Fallacies of Distributed Computing”</a>
(rephrased below as statements about how distributed systems <strong>actually</strong>
work):</p>

<ol>
  <li>The network is unreliable (messages can be out of order or lost, or
connectivity may be dropped altogether).</li>
  <li>Latency is non-zero.</li>
  <li>Bandwidth is finite.</li>
  <li>The network is insecure.</li>
  <li>Topology changes.</li>
  <li>There are multiple administrators.</li>
  <li>Transport cost is non-zero.</li>
  <li>The network is heterogenous.</li>
</ol>

<h2 id="conclusion">Conclusion</h2>

<p>The design space for production cloud-based data services is huge. The
service architect and implementation team must trade off between many
conflicting goals and build a service that integrates well with the
operations of the organization as a whole. This design process turns a
robust, accurate data model—the kernel of a service but not an
actual service—into a production service.</p>



</div>




<div id="disqus_thread"></div>
<script>

var disqus_config = function () {
this.page.url = "http://kirkpatricktech.com/2019/12/31/design-space-2020/";
//this.page.identifier = "/2019/12/31/design-space-2020";
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://kirkpatricktech-com.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

    </div>

  </body>
</html>
